# 异步I/O与事件驱动

## 非阻塞I/O

首先要明确非阻塞I/O与异步I/O是不一样的概念，其次就是node的单线程指的是执行js是单线程，执行I/O任务是有其他线程池的

非阻塞I/O就是应用层对I/O设备发出查询请求，不带数据立即返回，然后利用轮询去查看何时有结果
这种轮询也经历了不断地进步，从不断的发送read；到后来select一次可以检查很多次，因为是数组；到后来的poll，以链表形式突破了长度限制；到后来的epoll，该方案是linux下效率最高的事件唤醒，因为他会休眠到结束，而不会一直轮询。还有kqueue，不过这个只在FressBSD系统下存在。

## node的异步I/O实现

事件循环、观察者、执行回调、I/O线程池实现了node的异步I/O

每执行一次事件循环的过程称为Tick。每次Tick，先看有没有事件，如有就取出来，看他有没有回调，有就执行回调，没有继续看有没有事件，直至事件被取光，退出Tick。
其中每次看有没有事件，是观察者提供的，它监控着I/O线程池，一触发事件就交给线程池

我们可以打个比方

饭店里面，厨师做完手头最后一道菜，就回去询问服务员（观察者）有没有客人点菜（I/O线程池），如果有就继续去做（取出事件，有回调就执行回调）
直到无人点菜，就下班。这就是一个事件循环了