## 组件

### 使用组件

#### 注册组件的方法

```javascript
Vue.component('my-component', {
  // 选项
})
```
然后在父组件中以自定义元素使用
```html
<div id="example">
  <my-component></my-component>
</div>
```

#### 局部注册

上面的注册组件的方法，得到的是一个独立的、可复用的组件。可以作为任意父组件的子组件。   

组件也可以局部注册，这样就只能在某一个父组件中使用它了
```javascript
var Child = {
  template: '<div>A custom component!</div>'
};
new Vue({
  // ...
  components: {
    // <my-component> 将只在父模板可用
    'my-component': Child
  }
});
```

#### data必须是函数

```javascript
Vue.component('my-component', {
  template: '<span>{{ message }}</span>',
  data: {
    message: 0
  }
})
```
如果这么做，vue是会报错的，我们这样来模拟
```javascript
var data = {num: 0};
Vue.component('my-component', {
  template: '<span>{{ message }}</span>',
  data: function(){
      return data;
  }
})
```
我们使用三次这个组件，并且每个都对`data.num`进行了操作，那么其他的也会跟着变
    
这其实就是个闭包的问题，如果data不是函数，那么每次使用组件都是公用的一个data，只有用函数才能   
让这些data互相独立

#### 构成组件

组件意味着互相协同工作，父组件要将数据传给子组件，子组件将它内部发生的事情告诉父组件，同时尽可能的父子组件解耦    
因此，在vue中，父组件通过props给子组件传数据，子组件通过events给父组件发消息

### Prop

#### 使用Prop传递数据

组件实例的作用域是孤立的，这就意味着不能在子组件内直接引用父组件内的数据    
因此我们需要通过子组件的`props`选项来使用父组件的数据

```html
<div>
  <input v-model="parentMsg">
  <br>
  <child v-bind:my-message="parentMsg"></child>
</div>
```
```javascript
Vue.component('child', {
  // camelCase in JavaScript
  props: ['myMessage'],
  template: '<span>{{ myMessage }}</span>'
})
```
使用v-bind语法，将父组件的数据动态的绑定到子模板的props，每当父组件的数据发生变化时也会传递给子组件

#### 单向数据流

prop是单向绑定的，这是为了防止子组件无意中修改了父组件的状态

所以不应该在子组件内改变prop，因为如果它是引用类型的，就会影响父组件 

当我们要在子组件内使用prop时，应该定义一个局部变量，并用prop的值初始化它

#### Prop 验证

我们可以为组件的 props 指定验证规格。如果传入的数据不符合规格，Vue 会发出警告。当组件给其他人使用时，这很有用

```javascript
Vue.component('example', {
  props: {
    // 基础类型检测 (`null` 意思是任何类型都可以)
    propA: Number,
    // 多种类型
    propB: [String, Number],
    // 必传且是字符串
    propC: {
      type: String,
      required: true
    },
    // 数字，有默认值
    propD: {
      type: Number,
      default: 100
    },
    // 数组/对象的默认值应当由一个工厂函数返回
    propE: {
      type: Object,
      default: function () {
        return { message: 'hello' }
      }
    },
    // 自定义验证函数
    propF: {
      validator: function (value) {
        return value > 10
      }
    }
  }
})
```